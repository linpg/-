import React, { useState, useEffect, useRef } from 'react';
import { 
  Mic, Play, Pause, RotateCcw, CheckCircle, 
  XCircle, Home, BookOpen, MessageCircle, 
  Award, Settings, ChevronRight, Volume2, 
  Languages, Star
} from 'lucide-react';

// --- Data & Content ---

const LESSONS = [
  {
    id: 1,
    title: "åŸºæœ¬å•å€™",
    desc: "å­¸æœƒå¦‚ä½•æ‰“æ‹›å‘¼å’Œå•å¥½",
    level: "å…¥é–€",
    color: "from-purple-500 to-indigo-500",
    dialogues: [
      { id: 1, thai: "à¸ªà¸§à¸±à¸ªà¸”à¸µ", pinyin: "Sawasdee", cn: "ä½ å¥½", speaker: "A" },
      { id: 2, thai: "à¸ªà¸šà¸²à¸¢à¸”à¸µà¹„à¸«à¸¡", pinyin: "Sabai dee mai?", cn: "ä½ å¥½å—ï¼Ÿ", speaker: "B" },
      { id: 3, thai: "à¸ªà¸šà¸²à¸¢à¸”à¸µ", pinyin: "Sabai dee", cn: "æˆ‘å¾ˆå¥½", speaker: "A" },
      { id: 4, thai: "à¸‚à¸­à¸šà¸„à¸¸à¸“", pinyin: "Khob khun", cn: "è¬è¬", speaker: "B" },
    ]
  },
  {
    id: 2,
    title: "é¤å»³é»é¤",
    desc: "é»æ³°å¼ç‚’æ²³ç²‰å’Œé£²æ–™",
    level: "åˆç´š",
    color: "from-orange-400 to-red-500",
    dialogues: [
      { id: 1, thai: "à¸‚à¸­à¹€à¸¡à¸™à¸¹à¸«à¸™à¹ˆà¸­à¸¢", pinyin: "Khor menu noi", cn: "è«‹çµ¦æˆ‘èœå–®", speaker: "A" },
      { id: 2, thai: "à¹€à¸­à¸²à¸œà¸±à¸”à¹„à¸—à¸¢", pinyin: "Ao Pad Thai", cn: "æˆ‘è¦æ³°å¼ç‚’æ²³ç²‰", speaker: "A" },
      { id: 3, thai: "à¹„à¸¡à¹ˆà¹€à¸œà¹‡à¸”", pinyin: "Mai phet", cn: "ä¸è¾£", speaker: "A" },
      { id: 4, thai: "à¸™à¹‰à¸³à¹€à¸›à¸¥à¹ˆà¸²", pinyin: "Nam plao", cn: "ç™½é–‹æ°´", speaker: "A" },
    ]
  },
  {
    id: 3,
    title: "æ­ä¹˜è¨ˆç¨‹è»Š",
    desc: "å‘Šè¨´å¸æ©Ÿå»å“ªè£¡",
    level: "ä¸­ç´š",
    color: "from-green-400 to-teal-500",
    dialogues: [
      { id: 1, thai: "à¹„à¸›à¸ªà¸¢à¸²à¸¡à¸à¸²à¸£à¸²à¸à¸­à¸™", pinyin: "Pai Siam Paragon", cn: "å»æš¹ç¾…ç™¾éº—å®®", speaker: "A" },
      { id: 2, thai: "à¸à¸”à¸¡à¸´à¹€à¸•à¸­à¸£à¹Œà¹„à¸«à¸¡", pinyin: "Kod meter mai?", cn: "è·³éŒ¶å—ï¼Ÿ", speaker: "A" },
      { id: 3, thai: "à¹€à¸¥à¸µà¹‰à¸¢à¸§à¸‹à¹‰à¸²à¸¢", pinyin: "Liao sai", cn: "å·¦è½‰", speaker: "A" },
      { id: 4, thai: "à¸ˆà¸­à¸”à¸—à¸µà¹ˆà¸™à¸µà¹ˆ", pinyin: "Jod tee nee", cn: "åœåœ¨é€™è£¡", speaker: "A" },
    ]
  }
];

// --- Utilities ---

// Simple string similarity to simulate AI grading (0-100 score)
const calculateSimilarity = (str1, str2) => {
  const s1 = str1.toLowerCase().replace(/[^a-z0-9à¸-à¹™]/g, ""); // Include Thai chars range
  const s2 = str2.toLowerCase().replace(/[^a-z0-9à¸-à¹™]/g, "");
  
  if (s1 === s2) return 100;
  
  // Basic token matching overlap for MVP
  const tokens1 = s1.split('');
  const tokens2 = s2.split('');
  const intersection = tokens1.filter(x => tokens2.includes(x));
  
  const score = Math.round((intersection.length / Math.max(tokens1.length, tokens2.length)) * 100);
  return Math.max(0, Math.min(100, score)); // Clamp 0-100
};

// --- Components ---

const Navigation = ({ activeTab, setActiveTab }) => (
  <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 py-2 px-6 flex justify-between items-center z-50 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]">
    <button onClick={() => setActiveTab('home')} className={`flex flex-col items-center ${activeTab === 'home' ? 'text-purple-600' : 'text-gray-400'}`}>
      <Home size={24} />
      <span className="text-xs mt-1">é¦–é </span>
    </button>
    <button onClick={() => setActiveTab('learn')} className={`flex flex-col items-center ${activeTab === 'learn' ? 'text-purple-600' : 'text-gray-400'}`}>
      <BookOpen size={24} />
      <span className="text-xs mt-1">èª²ç¨‹</span>
    </button>
    <div className="relative -top-5">
      <button onClick={() => setActiveTab('speak')} className="bg-purple-600 text-white p-4 rounded-full shadow-lg hover:bg-purple-700 transition-colors border-4 border-white">
        <Mic size={28} />
      </button>
    </div>
    <button onClick={() => setActiveTab('quiz')} className={`flex flex-col items-center ${activeTab === 'quiz' ? 'text-purple-600' : 'text-gray-400'}`}>
      <Award size={24} />
      <span className="text-xs mt-1">æ¸¬é©—</span>
    </button>
    <button onClick={() => setActiveTab('profile')} className={`flex flex-col items-center ${activeTab === 'profile' ? 'text-purple-600' : 'text-gray-400'}`}>
      <Settings size={24} />
      <span className="text-xs mt-1">è¨­å®š</span>
    </button>
  </div>
);

const Header = ({ title, subtitle }) => (
  <div className="bg-gradient-to-r from-purple-600 to-indigo-600 p-6 text-white rounded-b-3xl shadow-lg mb-6">
    <h1 className="text-2xl font-bold">{title}</h1>
    {subtitle && <p className="text-purple-100 text-sm mt-1">{subtitle}</p>}
  </div>
);

// --- Feature Views ---

const HomeView = ({ onStartLesson }) => (
  <div className="pb-24">
    <Header title="Sawasdee! ğŸ™" subtitle="æº–å‚™å¥½å­¸ç¿’ä»Šå¤©çš„æ³°èªäº†å—ï¼Ÿ" />
    
    <div className="px-6 space-y-6">
      {/* Daily Stats */}
      <div className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex justify-between items-center">
        <div>
          <p className="text-gray-500 text-sm">ä»Šæ—¥å­¸ç¿’</p>
          <p className="text-2xl font-bold text-gray-800">15 <span className="text-sm font-normal text-gray-400">åˆ†é˜</span></p>
        </div>
        <div className="h-10 w-px bg-gray-200"></div>
        <div>
          <p className="text-gray-500 text-sm">å·²æŒæ¡è©å½™</p>
          <p className="text-2xl font-bold text-gray-800">42 <span className="text-sm font-normal text-gray-400">å€‹</span></p>
        </div>
      </div>

      {/* Continue Learning */}
      <div>
        <h3 className="text-lg font-bold text-gray-800 mb-3">ç¹¼çºŒå­¸ç¿’</h3>
        <div 
          onClick={() => onStartLesson(LESSONS[0])}
          className="bg-purple-50 p-4 rounded-2xl border border-purple-100 flex items-center justify-between cursor-pointer active:scale-95 transition-transform"
        >
          <div className="flex items-center gap-3">
            <div className="bg-purple-100 p-2 rounded-full text-purple-600">
              <Play size={20} fill="currentColor" />
            </div>
            <div>
              <p className="font-bold text-gray-800">åŸºæœ¬å•å€™</p>
              <p className="text-xs text-gray-500">é€²åº¦: 50%</p>
            </div>
          </div>
          <ChevronRight size={20} className="text-gray-400" />
        </div>
      </div>

      {/* Quick Actions */}
      <div className="grid grid-cols-2 gap-4">
        <button onClick={() => onStartLesson(LESSONS[1])} className="bg-orange-50 p-4 rounded-2xl border border-orange-100 text-left hover:bg-orange-100 transition-colors">
          <Languages className="text-orange-500 mb-2" />
          <p className="font-bold text-gray-800">è©å½™å¡</p>
          <p className="text-xs text-gray-500">ä»Šæ—¥ 10 å€‹æ–°è©</p>
        </button>
        <button onClick={() => onStartLesson(LESSONS[2])} className="bg-blue-50 p-4 rounded-2xl border border-blue-100 text-left hover:bg-blue-100 transition-colors">
          <MessageCircle className="text-blue-500 mb-2" />
          <p className="font-bold text-gray-800">æƒ…å¢ƒå°è©±</p>
          <p className="text-xs text-gray-500">æ¨¡æ“¬çœŸå¯¦å ´æ™¯</p>
        </button>
      </div>
    </div>
  </div>
);

const LearnView = ({ onSelectLesson }) => (
  <div className="pb-24">
    <Header title="èª²ç¨‹åˆ—è¡¨" subtitle="é¸æ“‡ä¸€å€‹ç”Ÿæ´»å ´æ™¯é–‹å§‹" />
    <div className="px-4 space-y-4">
      {LESSONS.map((lesson) => (
        <div 
          key={lesson.id} 
          onClick={() => onSelectLesson(lesson)}
          className="bg-white rounded-2xl p-5 shadow-sm border border-gray-100 cursor-pointer hover:shadow-md transition-all active:scale-95"
        >
          <div className="flex justify-between items-start mb-2">
            <span className={`text-xs font-bold px-2 py-1 rounded text-white bg-gradient-to-r ${lesson.color}`}>
              {lesson.level}
            </span>
          </div>
          <h3 className="text-xl font-bold text-gray-800">{lesson.title}</h3>
          <p className="text-gray-500 text-sm mt-1">{lesson.desc}</p>
        </div>
      ))}
    </div>
  </div>
);

const LessonDetailView = ({ lesson, onBack }) => {
  const speakText = (text) => {
    if ('speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'th-TH'; // Thai language code
      utterance.rate = 0.9; // Slightly slower for learning
      window.speechSynthesis.speak(utterance);
    } else {
      alert("æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³åˆæˆ");
    }
  };

  return (
    <div className="pb-24 bg-gray-50 min-h-screen">
      <div className="sticky top-0 bg-white shadow-sm z-10 px-4 py-3 flex items-center gap-3">
        <button onClick={onBack} className="p-2 hover:bg-gray-100 rounded-full">
          <ChevronRight className="rotate-180 text-gray-600" />
        </button>
        <h2 className="font-bold text-lg text-gray-800">{lesson.title}</h2>
      </div>

      <div className="p-4 space-y-4">
        {lesson.dialogues.map((line, idx) => (
          <div key={idx} className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex gap-4 items-start">
            <button 
              onClick={() => speakText(line.thai)}
              className="mt-1 min-w-[40px] h-[40px] rounded-full bg-purple-100 flex items-center justify-center text-purple-600 hover:bg-purple-200 active:scale-95 transition-all"
            >
              <Volume2 size={20} />
            </button>
            <div className="flex-1">
              <p className="text-xl font-bold text-gray-800 font-thai">{line.thai}</p>
              <p className="text-purple-600 font-medium text-sm">{line.pinyin}</p>
              <p className="text-gray-500 text-sm mt-1">{line.cn}</p>
            </div>
          </div>
        ))}
      </div>
      
      <div className="fixed bottom-24 left-0 right-0 px-6">
        <div className="bg-blue-50 text-blue-800 text-xs p-3 rounded-lg text-center border border-blue-100">
           æç¤ºï¼šé»æ“Šå–‡å­åœ–ç¤ºè½ç™¼éŸ³
        </div>
      </div>
    </div>
  );
};

const SpeakPracticeView = () => {
  const [isListening, setIsListening] = useState(false);
  const [transcript, setTranscript] = useState('');
  const [feedback, setFeedback] = useState(null); // null, 'success', 'try-again'
  const [score, setScore] = useState(0);
  const [currentIdx, setCurrentIdx] = useState(0);

  // Flatten all dialogues for practice
  const practiceSentences = LESSONS.flatMap(l => l.dialogues);
  const currentSentence = practiceSentences[currentIdx];

  const recognitionRef = useRef(null);

  useEffect(() => {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognitionRef.current = new SpeechRecognition();
      recognitionRef.current.continuous = false;
      recognitionRef.current.interimResults = true; // Show results as speaking
      recognitionRef.current.lang = 'th-TH';

      recognitionRef.current.onresult = (event) => {
        const current = event.resultIndex;
        const transcriptText = event.results[current][0].transcript;
        setTranscript(transcriptText);
      };

      recognitionRef.current.onend = () => {
        setIsListening(false);
        // Only evaluate if we have text
        if (transcript) {
            evaluateSpeech(transcript);
        }
      };
      
      recognitionRef.current.onerror = (event) => {
        console.error("Speech error", event.error);
        setIsListening(false);
      };

    } else {
      alert("æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜ï¼Œè«‹ä½¿ç”¨ Chrome ç€è¦½å™¨ã€‚");
    }
  }, [currentIdx, transcript]); 
  
  // Custom evaluator helper
  const evaluateSpeech = (finalText) => {
      const simScore = calculateSimilarity(finalText, currentSentence.thai);
      setScore(simScore);
      if (simScore > 60) {
        setFeedback('success');
      } else {
        setFeedback('try-again');
      }
  };

  const toggleListening = () => {
    if (isListening) {
      recognitionRef.current.stop();
      // Evaluation happens in onend
    } else {
      setTranscript('');
      setFeedback(null);
      setScore(0);
      try {
        recognitionRef.current.start();
        setIsListening(true);
      } catch(e) {
        console.error("Start error", e);
      }
    }
  };

  const playTargetAudio = () => {
    const u = new SpeechSynthesisUtterance(currentSentence.thai);
    u.lang = 'th-TH';
    window.speechSynthesis.speak(u);
  };

  const nextSentence = () => {
    setTranscript('');
    setFeedback(null);
    setScore(0);
    setCurrentIdx((prev) => (prev + 1) % practiceSentences.length);
  };

  return (
    <div className="pb-24 h-screen flex flex-col bg-gray-50">
      <Header title="AI å£èªªæ•™ç·´" subtitle="åƒæ¯èªè€…ä¸€æ¨£é–‹å£èªª" />
      
      <div className="flex-1 px-6 flex flex-col items-center justify-center space-y-8">
        
        {/* Card */}
        <div className="w-full bg-white rounded-3xl p-8 shadow-lg text-center border border-gray-100 relative overflow-hidden">
            {/* Progress indicator */}
            <div className="absolute top-0 left-0 h-1 bg-purple-600 transition-all duration-300" style={{width: `${score}%`}}></div>
            
            <p className="text-gray-500 text-sm mb-2">è«‹å”¸å‡ºä¸‹é¢çš„å¥å­ï¼š</p>
            <h3 className="text-3xl font-bold text-gray-800 mb-2 font-thai">{currentSentence.thai}</h3>
            <p className="text-purple-600 font-medium mb-4">{currentSentence.pinyin}</p>
            
            <button onClick={playTargetAudio} className="inline-flex items-center gap-2 text-gray-500 text-sm bg-gray-100 px-3 py-1 rounded-full hover:bg-gray-200">
                <Volume2 size={14} /> æ’­æ”¾åŸéŸ³
            </button>
        </div>

        {/* Feedback Area */}
        <div className="h-32 w-full flex flex-col items-center justify-center">
            {isListening ? (
                <div className="flex flex-col items-center animate-pulse">
                    <span className="text-purple-600 font-bold mb-2">æ­£åœ¨è½...</span>
                    <div className="flex gap-1">
                        <div className="w-1 h-4 bg-purple-400 animate-[bounce_1s_infinite]"></div>
                        <div className="w-1 h-6 bg-purple-500 animate-[bounce_1.1s_infinite]"></div>
                        <div className="w-1 h-4 bg-purple-400 animate-[bounce_1.2s_infinite]"></div>
                    </div>
                    <p className="text-gray-400 text-xs mt-2">{transcript || "è«‹èªªè©±..."}</p>
                </div>
            ) : feedback ? (
                <div className="text-center animate-in fade-in slide-in-from-bottom-4">
                    {feedback === 'success' ? (
                        <>
                            <div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2 text-green-600">
                                <CheckCircle size={32} />
                            </div>
                            <p className="font-bold text-green-700">å¤ªæ£’äº†! æº–ç¢ºåº¦: {score}%</p>
                            <p className="text-xs text-gray-500 mt-1">è¾¨è­˜: {transcript}</p>
                        </>
                    ) : (
                        <>
                            <div className="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2 text-red-600">
                                <XCircle size={32} />
                            </div>
                            <p className="font-bold text-red-700">å†è©¦ä¸€æ¬¡? æº–ç¢ºåº¦: {score}%</p>
                            <p className="text-xs text-gray-500 mt-1">è¾¨è­˜: {transcript}</p>
                        </>
                    )}
                </div>
            ) : (
                <p className="text-gray-400 text-sm">é»æ“Šéº¥å…‹é¢¨é–‹å§‹è·Ÿè®€</p>
            )}
        </div>

        {/* Controls */}
        <div className="flex items-center gap-6">
            <button 
                onClick={toggleListening}
                className={`w-20 h-20 rounded-full flex items-center justify-center shadow-xl transition-all ${
                    isListening ? 'bg-red-500 text-white scale-110' : 'bg-purple-600 text-white hover:bg-purple-700'
                }`}
            >
                {isListening ? <Pause size={32} fill="currentColor" /> : <Mic size={32} />}
            </button>

            {(feedback === 'success' || feedback === 'try-again') && (
                <button 
                    onClick={nextSentence}
                    className="absolute right-6 bottom-32 bg-gray-800 text-white p-3 rounded-full shadow-lg hover:bg-gray-700"
                >
                    <ChevronRight size={24} />
                </button>
            )}
        </div>

      </div>
    </div>
  );
};

const QuizView = () => {
  const [qIndex, setQIndex] = useState(0);
  const [score, setScore] = useState(0);
  const [showResult, setShowResult] = useState(false);
  const [selectedOption, setSelectedOption] = useState(null);

  // Generate simple quiz data based on lessons
  const allDialogues = LESSONS.flatMap(l => l.dialogues);
  // Shuffle utility
  const shuffle = (array) => [...array].sort(() => Math.random() - 0.5);
  
  const [quizData] = useState(() => {
    // Create 5 random questions
    const pool = shuffle(allDialogues).slice(0, 5);
    return pool.map(item => {
        const wrongOptions = shuffle(allDialogues.filter(d => d.id !== item.id)).slice(0, 3).map(d => d.cn);
        return {
            questionAudio: item.thai,
            correct: item.cn,
            options: shuffle([item.cn, ...wrongOptions])
        };
    });
  });

  const handleAnswer = (option) => {
    setSelectedOption(option);
    if (option === quizData[qIndex].correct) {
      setScore(s => s + 1);
    }
    
    setTimeout(() => {
      if (qIndex < quizData.length - 1) {
        setQIndex(prev => prev + 1);
        setSelectedOption(null);
      } else {
        setShowResult(true);
      }
    }, 1000); // Delay to show color feedback
  };

  const playQuestionAudio = () => {
    const u = new SpeechSynthesisUtterance(quizData[qIndex].questionAudio);
    u.lang = 'th-TH';
    window.speechSynthesis.speak(u);
  };

  const restartQuiz = () => {
    setQIndex(0);
    setScore(0);
    setShowResult(false);
    setSelectedOption(null);
  };

  if (showResult) {
    return (
      <div className="flex flex-col items-center justify-center h-screen bg-purple-50 p-6 pb-24">
        <Award size={64} className="text-yellow-500 mb-4" />
        <h2 className="text-2xl font-bold text-gray-800 mb-2">æ¸¬é©—å®Œæˆ!</h2>
        <p className="text-gray-600 mb-6">ä½ çš„å¾—åˆ†</p>
        <div className="text-6xl font-bold text-purple-600 mb-8">{score} / {quizData.length}</div>
        <button onClick={restartQuiz} className="bg-purple-600 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-purple-700 transition-colors flex items-center gap-2">
            <RotateCcw size={20} /> å†æ¸¬ä¸€æ¬¡
        </button>
      </div>
    );
  }

  const currentQ = quizData[qIndex];

  return (
    <div className="pb-24 min-h-screen bg-gray-50">
       <Header title="è½åŠ›å¤§æŒ‘æˆ°" subtitle={`ç¬¬ ${qIndex + 1} / ${quizData.length} é¡Œ`} />
       
       <div className="px-6 mt-8">
         <div className="bg-white p-8 rounded-3xl shadow-lg border border-gray-100 flex flex-col items-center mb-8">
            <button 
                onClick={playQuestionAudio}
                className="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 mb-4 hover:scale-105 transition-transform"
            >
                <Volume2 size={32} />
            </button>
            <p className="text-gray-500 text-sm">é»æ“ŠæŒ‰éˆ•æ’­æ”¾æ³°èª</p>
         </div>

         <div className="space-y-3">
            {currentQ.options.map((opt, idx) => {
                let btnClass = "bg-white border-gray-200 text-gray-700 hover:bg-gray-50";
                if (selectedOption) {
                    if (opt === currentQ.correct) btnClass = "bg-green-100 border-green-300 text-green-700";
                    else if (opt === selectedOption) btnClass = "bg-red-100 border-red-300 text-red-700";
                    else btnClass = "opacity-50 bg-gray-100";
                }

                return (
                    <button
                        key={idx}
                        disabled={!!selectedOption}
                        onClick={() => handleAnswer(opt)}
                        className={`w-full p-4 rounded-xl border-2 font-medium transition-all ${btnClass}`}
                    >
                        {opt}
                    </button>
                );
            })}
         </div>
       </div>
    </div>
  );
};

// --- Main App Container ---

const ThaiLearningApp = () => {
  const [activeTab, setActiveTab] = useState('home');
  const [selectedLesson, setSelectedLesson] = useState(null);

  const handleStartLesson = (lesson) => {
    setSelectedLesson(lesson);
    setActiveTab('learn');
  };

  const renderContent = () => {
    // If a lesson is selected inside Learn tab
    if (activeTab === 'learn' && selectedLesson) {
        return <LessonDetailView lesson={selectedLesson} onBack={() => setSelectedLesson(null)} />;
    }

    switch (activeTab) {
      case 'home': return <HomeView onStartLesson={handleStartLesson} />;
      case 'learn': return <LearnView onSelectLesson={(l) => { setSelectedLesson(l); }} />;
      case 'speak': return <SpeakPracticeView />;
      case 'quiz': return <QuizView />;
      case 'profile': return (
        <div className="flex flex-col items-center justify-center h-screen pb-24 text-gray-400">
            <Settings size={48} className="mb-4 opacity-50" />
            <p>è¨­å®šåŠŸèƒ½é–‹ç™¼ä¸­...</p>
        </div>
      );
      default: return <HomeView />;
    }
  };

  return (
    <div className="font-sans bg-gray-50 min-h-screen text-gray-900 max-w-md mx-auto relative shadow-2xl overflow-hidden">
      {/* Dynamic Content */}
      <div className="h-full overflow-y-auto scrollbar-hide">
        {renderContent()}
      </div>

      {/* Bottom Navigation */}
      <Navigation activeTab={activeTab} setActiveTab={(tab) => {
        setActiveTab(tab);
        if (tab !== 'learn') setSelectedLesson(null);
      }} />
    </div>
  );
};

export default ThaiLearningApp;
